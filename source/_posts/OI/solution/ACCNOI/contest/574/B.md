---
title: 忍者小队（迭代加深搜索+计数 解决 最小+可行）
message: dsfz NOI篇 的密码
tags:
  - accnoi
  - 容斥
  - 计数
date: 2024-11-16 13:09:52
---

### [忍者小队](http://47.92.197.167:5283/contest/574/problem/2)

- 题目简述：有 $n$ 个数 $a_i$，$F(S)=\gcd\limits_{i\in S}a_i$，求对于 $k\in [1,m]$，是否存在 $F(S)=k$，若存在则 $min({|S|,F(S)=k}),max(|S|,F(S)=k)$ 分别是多少
- $n,m\le 3\times 10^5$
- 题目分析：
- 最大，就是尽可能选没用的，显然对于 $k$，若存在则最大为 $gcd({a_i|(k\mid a_i)})$。这显然是好做的
- 最小，是问题关键，从答案角度考虑，每次给一个集合加一个数，若 $F(S)$ 与 $F(S')$ 之间没有变化，加入就一定不是最小的方案。
- 由此，得出 $2\times 3\times \cdots \times 19>3\times 10^5$，前 $7$ 个质数相乘就足够了，所以答案最大为 $7$
- 这里为什么不会出现一堆 $2$ 的相乘的情况呢，很简单，我们一定存在一次操作一步到位，为什么要那么多 $2$ 呢
- 至此已有结论：答案 $\le 7$
- 接着，如何判断可行，我们尝试 $dp_{i,j}$ 表示取 $i$ 个数，答案（即gcd）为 $j$ 是否可行，尝试写转移
- 设 $p_x=\sum [x\mid a_i]$
- $dp_{i,j}=\binom{p_x}{i}-\cdots$，这里一想就有问题，我们存在真实的 $gcd$ 比 $i$ 大，但是都是 $i$ 的倍数
- 那就减去 $dp_{i,j}=\binom{p_x}{i}-\sum_{k=2}^{\frac{n}{i}}dp_{ik,j}$
- 就完事了，[具体如下](http://47.92.197.167:5283/submission/260155)
