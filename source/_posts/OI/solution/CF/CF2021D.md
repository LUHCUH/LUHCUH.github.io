---
title: "Boss, Thirsty，(谁说极值问题，不能重复统计？)"
tags:
  - Codeforces
  - dp
date: 2024-11-19 21:56:41
---
### [CF2021D Boss, Thirsty，(谁说极值问题，不能重复统计？)](https://www.luogu.com.cn/problem/CF2021D)
- 题目简述：商店有 $m$ 个编号连续的商品，每天卖出连续的一段标号的商品，共卖 $n$ 天，要求 $i$，$i+1$ 天卖的商品不能完全相同，还要有交集。$n\times m\le 2\times 10^5$
- 题目分析
- 分类讨论，前后两天能区间选择的情况，用 $l_i,r_i$ 分别表示第 $i$ 天选的物品区间
  - $l_i< l_{i-1}\le r_{i-1} \le r_i$
  - $l_i\le l_{i-1}\le r_{i-1} < r_i$
  - $l_i < l_{i-1}\le r_i\le r_{i-1}$
  - $l_{i-1} \le l_i \le r_{i-1} < r_i$
- 这。。。不太好统计，瞪大眼睛，发现，是否可以吧 $1,3$ 归类到 $2,4$ 呢？
  - $l_i< l_{i-1}\le r_i$
  - $l_i\le r_{i-1} < r_i$
- 什么意思呢，当前区间的选择，只与上一个点的左右端点有关。
- 于是，设 $L_{i,j}$ 表示第 $i$ 天，左端点是 $j$ 的 $max$
- 同理，设 $R_{i,j}$ 表示第 $i$ 天，右端点是 $j$ 的 $max$
$$
\begin{aligned}
L_{i,j}&=\max_{k=j+1}^m(L_{i-1,k}+\max_{t=k}^m s_t)-s_{j-1}\\
R_{i,j}&=\max_{k=1}^j(L_{i-1,k}-\min_{t=0}^{k-2} s_t)+s_j\\
&\cdots
\end{aligned}
$$
- 剩下的两个式子类似，像 $\min_{t=0}^{k-2}s_t$ 这种显然可以预处理，化为常数。
- 对于 $i$ 相同，$(L_{i-1,k}-\min_{t=0}^{k-2} s_t)$ 这里面的值只和 $k$ 有关，显然可以对于每一个 $i$ 拿出来 $O(k)$ 预处理，前缀，后缀。[参考实现](https://www.luogu.com.cn/problem/solution/CF2021D)
### 总结

- 本题最重要的想必就是，贡献合并了吧，求最大值最小值往往可以通过重复计算降低复杂度哟！