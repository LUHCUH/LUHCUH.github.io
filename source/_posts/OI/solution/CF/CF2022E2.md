---
title: Billetes MX (Hard Version)
tags:
  - Codeforces
  - bit
  - 分析题目
date: 2024-11-20 07:47:49
---

### [Billetes MX (Hard Version)](https://www.luogu.com.cn/problem/CF2022E2)

- 题目简述：有一个矩阵，$n\times m$ 的，满足存在任意矩形的四个角 $a_{i,j},a_{i,k},a_{t,j},a_{t,k}$ 使得他们四个的异或和为 $0$。给定初始矩阵，若干未知未知，数取值 $a_{i,j}\in [1,2^{30}-1]$，有多少满足条件的矩阵。
- 题目分析，首先有对于任意两列 $i,j$ 枚举虽有行有 $a_{x,i}\oplus a_{x,j}=v$，对于这一行来讲 $v$ 是一个定值，我们考虑所有数都由我们来钦定的答案。对于每一列我们枚举它和列 $1$ 的 $v$ 的异或值，对于第一列的每一个数我们都枚举所有值，即可确定矩阵，$(2^{30})^{n+m-1}$ 种方案。
- 为了方便我们扩展出钦定的 $0$ 列，$a_{0,i}$ 的取值钦定为 $0$ 固定，但是我们可以不固定的算，最后答案除 $2^{30}$，对于 $i\in [1,m]$ 都有 $v_i$
- 考虑固定一个点 $a_{i,j}$ 相当于绑定，$v_i,a_{0,j}$，用并查集维护即可。
- 如何判读无解呢，就是若发现 $u,v$ 以在同一个联通块内，若发现 $u,v$ 的异或路径不等于新加的点权就错了。
- 即存在非 $0$ 异或环，这样每个数都不确定必然是错的。