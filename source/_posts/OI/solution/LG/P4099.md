---
title: '[HEOI2013] SAO'
tags:
  - 洛谷
  - 拓扑序
date: 2024-11-14 18:44:43
---
### [[HEOI2013] SAO](https://www.luogu.com.cn/problem/P4099)
- 题目简述：有一个树，树的每条边是单向的，对其的拓扑方案计数 $n\le 1000$
- 题解：
- 设 $dp_{u,p}$ 表示 $u$ 子树的拓扑序中 $u$ 节点在第 $p$ 个被删的方案数
- 考虑转移：
- 相当于有两个区间，$s_u=[\cdots,u(p_1),\cdots]$，$s_v=[\cdots,v(p_2),\cdots]$，$s_u,s_v$ 是区间大小，$p_1,p_2$ 是所处位置。要把这两个区间合并成大区间，$[\cdots,u(p_3),\cdots]$
- 考虑 $u$ 要求 $p_1<p_2$ 的转移，$\sum_{p_3\le s_v+p_1-1}\binom{p_3-1}{p_1-1}\binom{s_u+s_v-p_3}{s_u-p_1}dp_{v,p_2}dp_{u,p_1}$
- 第二种情况类似 呱 ！
- 之后什么前缀和一下，就行了