---
title: '[JSOI2011] 分特产'
tags:
  - 洛谷
date: 2024-11-14 18:40:48
---
### [[JSOI2011] 分特产](https://www.luogu.com.cn/problem/P5505)

- 生气了！我也就能独立做出这种题了，太菜了
- 题目简述：$n$ 种物品，每个种物品有 $a_i$ 个，分给 $m$ 个人，每个人至少分的一个的方案数
- 其实一开始就想错了，什么先分给 $m$ 个人，再划分物品啥的，这都不可取，其实这是个废段
- 考虑不要求每个人至少得到一个，接着从物品角度出发，每个物品分给人的方案为 $\binom{a_i+n-1}{n-1}$
- 那么总答案就是 $\prod\limits_{i=1}^n\binom{a_i+n-1}{n-1}$，现在有限制，没得办法只能容斥。
- 设：钦定 $k$ 个人没有特产的方案数为 $F(k)$，恰好 $k$ 个人没有特产的方案数为 $G(k)$
- 有 $F(k)=\sum\limits_{d=0}^{n-k}\binom{n-k}{d}G(k+d)$，反演有 $ans=G(0)=\sum\limits_{d=0}^{n}\binom{n}{d}(-1)^dF(d)$
- 带入上面那坨，有 $ans=\sum\limits_{d=0}^{n-1}\binom{n}{d}(-1)^d\prod\limits_{i=1}^{n}\binom{a_i+n-d-1}{n-d-1}$。
- 注意呦！虽然反演的式子可以带 $n$ 但是 $n-d-1$ 导致 $d=n$ 组合数无意义，所以可以 $d\in[0,n-1]$