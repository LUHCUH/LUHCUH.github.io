---
title: '[ZJOI2016] 小星星'
tags:
  - 洛谷
date: 2024-11-14 18:41:20
---
### [[ZJOI2016] 小星星](https://www.luogu.com.cn/problem/P3349)

- 题目简述：
  - 你有一个图，你有一个树，你要在图中数树，这里数树相当于从定义编号，使其在原图存在。

- 首先考虑暴力：设 $dp_{u,s,x}$ 表示，在 $u$ 子树内，把 $u$ 的编号映射成 $x$，且已经选的集合为 $s$ 的方案数。这里写方程式的时候蒙住了。其实可以类似树上背包的过程。[具体如下](https://loj.ac/s/2177953)
- 之后，这道题的进一步做法就很神奇，我反正想不到。没准是你思考计数不重不漏计数方法，取决于划定一些极端条件，或是取决于更多的已知状态。尝试把 $s$ 去掉，去掉的后果是会有点被重复使用。那可容斥的地方就有了
- 我们设 $f(S)$ 表示，只使用点集 $S$ 中的点可重，构成原图的方案数。 $g(S)$ 表示，只使用点集 $S$ 中的点不可重复的方案数（虽然很奇怪，几乎都为 $0$）但应该都是对的。对于 $f(S)$ 的统计我们只需要枚举 $S$，设 $dp_{u,x}$，与上文含义相同。可以做到 $n^2$ 计算 $f(S)$，什么叫只用，就是说 $f$ 中我可以用的更少，根据反演有 $f(S)=\sum\limits_{T\subseteq S}g(T)$， $Ans=f(U)=\sum\limits_{T\subseteq U}(-1)^{|U|-|T|}g(T)$，总时间复杂度为 $O(n^32^n)$